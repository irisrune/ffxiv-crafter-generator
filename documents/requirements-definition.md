# FFXIV Crafter Generator 要件定義書

## 1 概要

### 1.1 背景

FF14のクラフター職において、スキル回しを1から構築するには知識や時間が必要となる。新式レシピやリーヴ納品レシピについてはスキル回しが確立されていることが多いものの、そうでないレシピにおいてスキル回しを考えるケースが存在する。その労力を削減することにメリットがあると判断した。

### 1.2 目的

キャラクターのステータスやレシピの情報を基に、クラフターのスキル回しを自動で作成する。

### 1.3 定義

|項目|説明|
|----|----|
|キャラクターのステータス|キャラクターのレベル・作業精度・加工精度・CPの総称|
|レシピの情報|レシピのレベル・必須作業精度・必須加工精度・必要工数・必要品質の総称|
|必要品質|品質の目標値からHQ素材使用による初期品質を引いた値|

## 2 業務要件

### 2.1 業務概要

既存のシミュレータを使う場合の作業フローを簡単に記す。

1. シミュレータにキャラクターのステータスとレシピの情報を入力する。
2. 様々なスキル回しを試し、効率の良いスキル回しができるまで繰り返す。
3. 完成したスキル回しをマクロとしてFF14で使用する。

### 2.2 規模

高難易度レシピを除く全てのレシピへの適用を想定する。

### 2.3 所要時間

現状の所要時間は長く見積もって1時間、システム化した場合は数分を想定する。

### 2.4 場所

個々人でのPCや携帯端末での使用を想定する。

### 2.5 システム化の範囲

1. スキル回しの生成フローを最優先でシステム化する。
2. マクロとしての出力フローを2番目にシステム化する。
3. キャラクターのステータスとレシピの情報を入力するフローを部分的にシステム化する。
   1. 食事や薬の情報入力の簡略化・レシピの情報入力の簡略化など。

### 2.6 管理指標

1. 正答率：必要工数・必要品質を満たすスキル回しを可能な限り出力することができるか。
   1. キャラクターのステータスによっては出力不可能なケースも存在する。
2. ターン数：最適なスキル回しを出力することができるか。
3. 処理時間：スキル回しの出力にどれくらい時間を要するか。

## 3 機能要件

### 3.1 システム機能

#### 3.1.1 スキル回しの生成

1. 必要工数・必要品質を満たすスキル回しを出力できない場合はその旨を出力する。
   1. 必要工数のみ満たすスキル回しが出力できる場合はできる限り品質を高めたマクロを出力する。
2. 必要工数・必要品質を満たすスキル回しが出力できる場合はターン数の最も少ないスキル回しのマクロを出力する。
3. 品質に影響されないスキル回しを出力するか品質に影響されるスキル回しを出力するかを選択できるようにする。
   1. 後者について、ビエルゴの祝福の実行時に低品質になるケースを回避するためマクロを分割できるようにする。
   2. 正確な表現として、ビエルゴの祝福の実行直前にイノベーションあるいはグレートストライドが実行される場合に、それらのスキルを実行する直前でマクロを分割する。
   3. 分割した場合、続きのマクロとしてイノベーションあるいはグレートストライドを実行するマクロと実行しないマクロの2つを生成する。
4. 入力として要求するパラメータは以下の通り。
   1. キャラクターのステータス
   2. レシピの情報
   3. 品質の影響を考慮するか
   4. 品質の影響を考慮しない場合にマクロを分割するか

#### 3.1.2 マクロの出力

1. 生成されたスキル回しを単一あるいは複数に分割したマクロに出力する。
2. FF14のマクロは15行までしか入力できないため、行数により分割を行う。
3. その他、上記スキル回しの生成にあるようにマクロの分割を行う場合もある。
4. マクロの出力は別ページあるいはモーダルウィンドウにより実装する。

#### 3.1.3 キャラクターのステータスとレシピの情報を入力

1. 最低限の機能実装として、キャラクターのステータスとレシピの情報を直接数値で入力する。
   1. このとき、薬・食事・マイスターの補正を含めたステータスを入力することになる。
2. 薬・食事・マイスターの補正を自動で入力できるようにする。
   1. 薬と食事についてはプルダウンメニューで選択できるようにする。
3. レシピの情報についてもプルダウンメニューで選択できるようにする。

### 3.2 画面

1. 最低限の機能実装として、文字ベースでの画面表示を行う。
2. 生成したスキル回しの表示を整理する。
3. SPA化を行う。

### 3.3 データ

本アプリケーションで用いるデータ項目は以下の通り。

|項目|補足|
|----|----|
|キャラクターのステータス|現仕様においては逐一入力し、データとして保持を行わない。|
|レシピの情報||
|薬の情報||
|食事の情報||
|スキルの情報|現仕様としてはハードコーディングによって対応する。|

### 3.4 外部インタフェース

レシピの情報を管理するために、xivapiを外部インタフェースとして使用する。

xivapi
https://xivapi.com/

## 4 非機能要件

### 4.1 ユーザビリティ及びアクセシビリティ

FF14プレイヤーがwebブラウザにて用いることを想定。なお、プレイヤーのクラフターに関する知識はスキルの効果を理解しているという程度を想定。

### 4.2 システム方式

システム方式として、webアプリと外部APIサーバを用意する。webアプリにおいてUI/UXを担当し外部APIサーバにてメイン処理を行う。

### 4.3 規模

個々人の利用を想定するため、ページアクセス数としては平均1回/分、ピークで10回/分を想定。

### 4.4 性能

ページ表示については1秒以内、出力処理については1分以内を想定。

### 4.5 信頼性

想定規模の利用において稼働率99%以上を想定。

### 4.6 拡張性

1. 規模・性能・信頼性に関する点での拡張性をクラウドサービスを用いることで担保する。
2. UI/UXやメイン処理については拡張性を考慮しない。

### 4.7 上位互換性

1. ユーザ情報を保持しないため、ユーザビリティ面では上方互換のみ担保し下方互換は担保しない。
2. xivapiに準ずる互換性は保留。

### 4.8 継続性

1. 本システム自体の不具合については冗長性を考慮しない。
2. xivapiの不具合については既に取得したデータを用いる形を取る。

### 4.9 情報セキュリティ

最高でもメールアドレス+パスワードによる認証に留める。

### 4.10 稼働環境

クラウドサービスを稼働環境として採用する。

### 4.11 テスト

1. 基本的に静的テストを行う。
2. 動的テストについては保留。
